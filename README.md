# React IMS & POS System

A comprehensive, local-first **Inventory Management and Point of Sale (POS)** system built with React, TypeScript, and Dexie.js. This application is designed to be offline-capable, secure via client-side encryption, and fully responsive.

---

## üìö Application Structure & Guide

### 1. Dashboard
The landing page provides a high-level overview of business performance.
*   **KPI Cards:**
    *   **Total Sales:** Gross revenue for the selected period.
    *   **Total Profit:** Net profit calculated based on settings (Revenue - COGS).
    *   **Total COGS:** Cost of Goods Sold.
    *   **Low Stock Items:** Count of items at or below their low stock threshold.
*   **Charts:**
    *   **Sales & Profit Overview:** A visual graph (Line or Bar) showing performance over time.
    *   **Time Ranges:** Controls to filter data by Today, Week, Month, Year, or All Time.
*   **Notifications:** Bell icon showing stock alerts (low stock/out of stock) and overdue purchase orders.

### 2. Point of Sale (POS)
The core interface for processing transactions.
*   **Shift Management:**
    *   **Open Shift:** Prompts for an opening float amount before sales can begin.
    *   **Close Shift:** Reconciles cash by comparing expected cash (Float + Sales - Refunds) vs. actual counted cash. Tracks variance.
*   **Tabs:**
    *   **Catalog:** A grid view of products. Supports search by Name/SKU and filtering by Category. Clicking a variable product opens a variant selector.
    *   **Returns / Lookup:** Search for past receipts by ID. Allows selecting specific line items from a past sale to process refunds.
*   **Cart Section:**
    *   **Line Items:** Shows name, variant details, price, and quantity. Quantity can be adjusted or removed.
    *   **Customer:** Attach a customer profile to the sale.
    *   **Action Buttons:**
        *   **Clear:** Empties the cart.
        *   **Discount:** Apply a fixed amount or percentage discount to the entire cart.
        *   **Tax:** Toggle or adjust tax settings for the specific order.
        *   **Hold:** Save the current order to the "Held Orders" list for later retrieval.
*   **Payment Modal:**
    *   **Totals:** Large display of Total Due or Refund Amount.
    *   **Split Payments:** Accept partial payments via multiple methods (Cash, Card, Other).
    *   **Change Calculation:** Automatically calculates change due for cash payments.

### 3. Inventory
Manage products, categories, and stock history.
*   **Tabs:**
    *   **Products:**
        *   **Table:** SKU, Name, Categories, Stock Level, Retail Price, Cost Price, Margin %.
        *   **Actions:**
            *   *History:* View detailed audit log of stock changes and price changes.
            *   *Receive:* Quickly add stock (simple products).
            *   *Adjust:* Manually correct stock levels with a reason (e.g., Damage, Theft).
            *   *Edit/Delete:* Modify product details or remove items (if no active stock).
        *   **Bulk Actions:** Select multiple rows to bulk delete or bulk edit categories.
    *   **Categories:**
        *   **Hierarchy:** View and manage nested product categories.
    *   **Valuation (Admin Only):**
        *   **Table:** Hierarchical view of inventory value. Shows Total Cost Value, Total Retail Value, and Potential Profit for parent products and their variants.

### 4. Procurement
Manage supply chain and incoming stock.
*   **Tabs:**
    *   **Purchase Orders (POs):**
        *   **Create PO:** Select a supplier and add items. Includes an "Auto Fill Low-Stock" feature to automatically populate items below threshold.
        *   **Table:** PO #, Supplier, Date Created, Total Cost, Status (Pending, Partial, Received).
        *   **Receiving:** Open a PO to receive items. Updates inventory stock automatically upon receipt.
    *   **Suppliers:**
        *   **Table:** Manage supplier contact details (Name, Contact Person, Email, Phone, Address).

### 5. Customers
Manage client database and view history.
*   **Tabs:**
    *   **Personal Data:** Table showing Name, Email, Phone, Address, and Registration Date.
    *   **Valuation & Sales:**
        *   **Metrics:** Total Orders, Total Spent, Total Profit generated by the customer, Last Visit date.
        *   **Details Modal:** Detailed breakdown of every purchase made by the customer with receipt lookups.

### 6. Users & Shifts
Manage staff access and audit work sessions.
*   **Tabs:**
    *   **Users:**
        *   **Table:** Username, Role (Admin/Cashier), Actions.
        *   **Permissions:** Configure granular permissions for the Cashier role (e.g., Allow returns, Hide reports).
    *   **Shifts:**
        *   **Table:** Audit log of all shifts. Shows Start/End time, Opened By, Opening Cash, Sales, Closing Cash, and Difference (Variance).

### 7. Reports
Historical data analysis.
*   **Sections:**
    *   **Transaction History:**
        *   **Filters:** Search by ID/Staff, Filter by Type (Sale/Return), Status, Salesperson, Date Range.
        *   **Table:** Detailed log of every transaction.
        *   **Receipt View:** Click any transaction to view/print the original receipt or process refunds.
    *   **Stock Levels:**
        *   **Table:** Filterable view of products by status (In Stock, Low Stock, Out of Stock).

### 8. Analysis
Deep dive into product performance.
*   **KPI Cards:** Highlights the top performing product by Revenue, Profit, and Quantity Sold.
*   **Performance Table:**
    *   **Columns:** Product Name, Units Sold, Revenue, Profit, Profit Margin %, Sell-Through Rate %.
    *   **Sorting:** Sort by any metric to identify best/worst performers.

### 9. Settings
Configuration hub for the application.
*   **Profile:** Update Username and Password.
*   **General:**
    *   **Theme:** Switch between Light, Dark, or System theme.
    *   **Zoom:** Adjust UI scaling.
    *   **Timezone:** Set local timezone offset for accurate reporting.
*   **Business Details:** Set Store Name, Store Code, Address, Phone, and Receipt Footer message.
*   **Currency & Payment:**
    *   **Currency:** Add/Select currencies (USD, EUR, JPY, etc.).
    *   **Formatting:** Toggle Integer-only mode (no decimals).
    *   **Tax:** Enable global tax rate and choose if tax is included in profit calculation.
    *   **Discount:** Enable global auto-discounts based on subtotal thresholds.
*   **Sync Settings:** Configure API URL and Key for remote server synchronization.
*   **View Settings:** Configure pagination limits per page type.
*   **Data Management:**
    *   **Import/Export:** CSV support for Products and Sales data.
    *   **Backup:** Download full JSON database dump (Encrypted).
    *   **Security:** View/Repair Encryption Keys.
    *   **Danger Zone:** Prune old data or Factory Reset the application.

---

## üöÄ Key Features

### üîê Security & Architecture
*   **Local-First Architecture:** All data is stored locally in the browser using IndexedDB (via Dexie.js).
*   **Client-Side Encryption:** Sensitive business data (profit, cost prices, customer details) is encrypted using the Web Crypto API (AES-GCM) before being saved to the database.
*   **Zero-Knowledge Auth:** The application derives encryption keys from your password. If the password is lost, data cannot be recovered without the **Recovery Key**.
*   **Offline Capable:** Works without an internet connection using Service Workers.

---

## üõ† Technology Stack

*   **Frontend:** React 18, TypeScript, Tailwind CSS
*   **Database:** Dexie.js (IndexedDB wrapper)
*   **Encryption:** Web Crypto API (PBKDF2 key derivation, AES-GCM encryption)
*   **Charts:** Recharts
*   **PDF/Image Generation:** html2canvas
*   **Icons:** Custom SVG Components

---

## üìñ Quick Start

1.  **Register Business:** Creates a new encrypted workspace. You will be given a **Store Code** and a **Recovery Key**. Save these immediately.
2.  **Demo Mode:** Enters a temporary guest session with seeded data. Data is wiped upon logout.
3.  **Start Shift:** Navigate to POS to open a shift.
4.  **Sell:** Add items, process payment, print receipt.

---

**License:** MIT
